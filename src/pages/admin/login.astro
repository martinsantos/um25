---
import Layout from '../../layouts/Layout.astro';

// Manejar el envío del formulario
if (Astro.request.method === 'POST') {
    try {
        const data = await Astro.request.formData();
        const password = data.get('password');

        if (password === process.env.ADMIN_SECRET) {
            Astro.cookies.set('adminAuth', process.env.ADMIN_SECRET, {
                path: '/',
                httpOnly: true,
                secure: true,
                sameSite: 'strict',
                maxAge: 60 * 60 * 24 // 24 horas
            });

            return Astro.redirect('/admin/comments');
        }
    } catch (error) {
        console.error('Error en el login:', error);
    }
}
---

<Layout title="Admin Login">
    <main class="min-h-screen flex items-center justify-center bg-gray-100">
        <div class="bg-white p-8 rounded-lg shadow-md w-full max-w-md">
            <h1 class="text-2xl font-bold text-center mb-6">Acceso Administrativo</h1>

            <form method="POST" class="space-y-6">
                <div>
                    <label for="password" class="block text-sm font-medium text-gray-700 mb-2">
                        Contraseña
                    </label>
                    <input
                        type="password"
                        id="password"
                        name="password"
                        required
                        class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent"
                    />
                </div>

                <button
                    type="submit"
                    class="w-full bg-primary-600 text-white px-6 py-3 rounded-lg hover:bg-primary-700 transition-colors"
                >
                    Iniciar Sesión
                </button>
            </form>
        </div>
    </main>
</Layout>
